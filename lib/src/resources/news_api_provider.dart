import 'package:http/http.dart' show Client;
import './repository.dart';
import 'dart:convert';
import '../models/item_model.dart';

final _root = 'https://hacker-news.firebaseio.com/v0';

class NewsApiProvider implements Source {
  Client client = Client();

  Future<List<int>> fetchTopIds() async {
    final response = await client.get(
      Uri.parse("$_root/topstories.json?print=pretty"),
    );
    final ids = json.decode(response.body);
    print("Fetch all top ids..");
    return ids.cast<int>(); //Future with list
  }

  Future<ItemModel> fetchItem(int id) async {
    final response = await client.get(
      Uri.parse('$_root/item/$id.json'),
    );
    final parsedJson = json.decode(response.body);
    print("Fetch Item... $id from api");
    return ItemModel?.fromJson(parsedJson);
  }
}

/*
[ 28162412, 28156831, 28160869, 28163722, 28157657, 28163546, 28164172, 28156460, 28161596, 28160673, 28158939, 28164221, 28155000, 28158435, 28154808, 28161397, 28156550, 28156656, 28159129, 28157085, 28153227, 28156094, 28160368, 28155196, 28156380, 28162563, 28164257, 28157768, 28161281, 28141080, 28155072, 28164349, 28158512, 28154477, 28160568, 28160977, 28162253, 28159437, 28157130, 28157117, 28140929, 28160553, 28125338, 28163550, 28155007, 28140800, 28154724, 28163769, 28158635, 28153655, 28158741, 28160635, 28150287, 28151881, 28161957, 28158788, 28155146, 28151817, 28149778, 28153523, 28143840, 28156469, 28157179, 28127565, 28160375, 28163558, 28160748, 28159305, 28152336, 28140374, 28153669, 28155244, 28143261, 28155980, 28154331, 28160491, 28151538, 28155929, 28133017, 28140998, 28154187, 28158320, 28159876, 28160231, 28140732, 28162519, 28160293, 28162428, 28160941, 28157679, 28152111, 28140621, 28162708, 28160159, 28162044, 28160467, 28157661, 28140288, 28151942, 28151482, 28158472, 28159865, 28136793, 28140980, 28150772, 28149805, 28155017, 28141462, 28143722, 28128729, 28133585, 28160184, 28156685, 28134871, 28138551, 28160019, 28163020, 28162316, 28130209, 28138844, 28162555, 28143238, 28161118, 28159708, 28164034, 28160091, 28142002, 28155988, 28141365, 28144567, 28127812, 28127492, 28140362, 28144867, 28160928, 28160926, 28160439, 28158311, 28143352, 28157724, 28134176, 28139376, 28141203, 28145998, 28141289, 28156818, 28158249, 28159780, 28161919, 28127834, 28160339, 28142850, 28144439, 28158912, 28138195, 28137226, 28122979, 28143853, 28159159, 28139603, 28150063, 28140598, 28150169, 28162900, 28136729, 28160660, 28158070, 28153845, 28118894, 28159113, 28155716, 28145209, 28160538, 28128445, 28137211, 28139242, 28127650, 28152174, 28141500, 28160291, 28141089, 28137361, 28145247, 28131745, 28156725, 28135065, 28162351, 28121929, 28122209, 28129906, 28138157, 28163015, 28141025, 28160808, 28142752, 28127098, 28157648, 28158567, 28129032, 28136391, 28144163, 28151372, 28137567, 28139117, 28158404, 28127817, 28160509, 28132330, 28153258, 28137852, 28155787, 28136599, 28142437, 28134653, 28128476, 28144034, 28138169, 28128957, 28126840, 28145875, 28130237, 28161037, 28148229, 28125809, 28136952, 28130213, 28120653, 28135792, 28126841, 28159915, 28157393, 28120483, 28150164, 28145918, 28137222, 28153044, 28128178, 28126826, 28125074, 28145843, 28148673, 28157985, 28134714, 28158651, 28146234, 28138161, 28118381, 28127798, 28159247, 28130560, 28119633, 28147593, 28144813, 28155974, 28119943, 28127240, 28127607, 28126399, 28123530, 28146647, 28122289, 28129330, 28129338, 28129159, 28121309, 28153041, 28122950, 28151420, 28153424, 28133329, 28146281, 28122375, 28140547, 28132161, 28159863, 28118350, 28159140, 28131737, 28131664, 28155585, 28140367, 28136120, 28141551, 28124183, 28119043, 28160503, 28135976, 28138837, 28145259, 28129938, 28162890, 28122799, 28148987, 28155924, 28147454, 28132182, 28124614, 28132830, 28150730, 28139048, 28140565, 28131721, 28136822, 28121108, 28121240, 28122318, 28123203, 28122935, 28132612, 28138001, 28142187, 28135113, 28119025, 28125249, 28129776, 28154303, 28145120, 28124761, 28119393, 28141258, 28123289, 28132873, 28161163, 28135106, 28151254, 28132756, 28121612, 28121374, 28147988, 28135218, 28120551, 28149764, 28146229, 28141397, 28144833, 28150003, 28123461, 28147787, 28127964, 28148829, 28120247, 28157281, 28135562, 28121870, 28149997, 28134593, 28132721, 28124032, 28132383, 28153764, 28127961, 28145667, 28149003, 28155852, 28126867, 28155792, 28135663, 28127020, 28129751, 28152240, 28153059, 28129335, 28132601, 28140710, 28122056, 28158578, 28127951, 28124676, 28122173, 28122090, 28144756, 28143743, 28138554, 28143884, 28156809, 28126421, 28143644, 28153463, 28130002, 28121060, 28145204, 28143796, 28143315, 28131257, 28151998, 28129480, 28123374, 28154517, 28134134, 28144984, 28144860, 28152743, 28159820, 28123684, 28145836, 28131363, 28135323, 28137980, 28135944, 28124249, 28133772, 28156678, 28146288, 28146285, 28144594, 28143563, 28151432, 28124975, 28127740, 28150546, 28127453, 28142615, 28140310, 28135138, 28119317, 28125183, 28158285, 28128360, 28136590, 28127446, 28151787, 28150231, 28143642, 28143771, 28134344, 28136009, 28129689, 28138780, 28145128, 28150794, 28125879, 28149284, 28124942, 28123847, 28129361, 28138513, 28138991, 28132114, 28133856, 28137189, 28145382, 28135168, 28121843, 28145094, 28142514, 28142067, 28129919, 28150682, 28128286, 28118839, 28143995, 28151821, 28135757, 28148788, 28136237, 28153429, 28140994, 28145951, 28137212, 28148758, 28120561, 28135452, 28137405, 28151197, 28120070, 28119537, 28131896, 28126622, 28150863, 28144455, 28122198, 28130650, 28143614, 28141561, 28129546, 28130672, 28118986, 28150629, 28137835, 28154548, 28120173, 28145914, 28122895, 28152500, 28149890, 28134174, 28145411, 28129190, 28139733, 28119162, 28145151, 28142528, 28141169, 28136557, 28144205, 28123369, 28140584, 28148341, 28129608, 28140340 ]
 */

// https://hacker-news.firebaseio.com/v0/topstories.json?print=pretty
// https://hacker-news.firebaseio.com/v0/item/28163546.json